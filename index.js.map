{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nlet currentPage = 1;\n\nexport const searchImage = async (search, perPage = 40) => {\n  const page = currentPage;\n  const url = `https://pixabay.com/api/`;\n  const loader = document.getElementById('loader');\n\n  loader.style.display = 'block';\n\n  try {\n    const response = await axios.get(url, {\n      params: {\n        key: '47161865-40d939b38272e547a09e56cd8',\n        q: search,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: perPage,\n        page: currentPage,\n      },\n    });\n\n    loader.style.display = 'none';\n    return response.data;\n  } catch (error) {\n    loader.style.display = 'none';\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n};\n\nexport const resetPage = () => {\n  currentPage = 1; \n};\n\nexport const nextPage = () => {\n  return ++currentPage;\n};\n\ncurrentPage = nextPage();","export const renderImages = images => {\n  return images\n    .map(image => renderSingleImage(image))\n    .join('');\n}; \n\nconst renderSingleImage = image => `\n    <li class='gallery-item'>\n      <a href=\"${image.largeImageURL}\">\n        <img alt=\"${image.tags}\" src=\"${image.webformatURL}\" class='gallery-image'/>\n      </a>\n      <ul class='list-info'>\n      ${renderImageInfo('Likes', image.likes)}\n      ${renderImageInfo('Views', image.views)}\n      ${renderImageInfo('Comments', image.comments)}\n      ${renderImageInfo('Downloads', image.downloads)}\n    </ul>\n  </li>\n`;\n\nconst renderImageInfo = (title, count) => `\n  <li class='item-info'>\n    <p class='title-info'>${title}</p>\n    <p class='count-info'>${count}</p>\n  </li>\n`;\n\nfunction checkLastPage(totalPages, currentPage) {\n  if (currentPage >= totalPages) {\n    document.getElementById('loadMoreButton').style.display = 'none';\n  } else {\n    document.getElementById('loadMoreButton').style.display = 'block';\n  }\n}\n\nfunction scrollSmoothly() {\n  const cardHeight = document.querySelector('.card').offsetHeight;\n  window.scrollBy({ \n    top: 2 * cardHeight, \n    behavior: 'smooth' \n  });\n}\n\nconst fetchData = async url => {\n const loader = document.getElementById('loader');\n  loader.style.display = 'block';\n\n  try {\n    const response = await fetch(url);\n    if (!response.ok) throw new Error('Network response was not ok');\n    return await response.json();\n  } finally {\n    loader.style.display = 'none';\n  }\n};\n\ndocument.getElementById('loadMoreButton').addEventListener('click', () => {\n  loadMore();\n});","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport { searchImage, resetPage, nextPage } from './js/pixabay-api';\nimport { renderImages } from './js/render-functions';\nimport errorIcon from './img/error.png';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('ul.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\niziToast.settings({\n  timeout: 4000,\n  position: 'topRight',\n});\n\nlet currentSearchText = '';\nlet currentPage = 1;\nlet totalPages = 0;\n\nconst createGallery = e => {\n  e.preventDefault();\n  gallery.innerHTML = '';\n  loader.style.display = 'block';\n  loadMoreBtn.style.display = 'none';\n  currentSearchText = e.target.elements.search.value.trim();\n\n  if (!currentSearchText) {\n    iziToast.error({\n      message: 'Please write a query for search',\n    });\n    loader.style.display = 'none';\n    return;\n  }\n\n  resetPage();\n  fetchAndRenderImages(currentSearchText).the(() => {\n    checkLastPage();\n  });\n};\n\n\n\nconst fetchAndRenderImages = searchText => {\n  loader.style.display = 'block';\n\n  searchImage(searchText)\n    .then(({ hits, totalHits  }) => {\n      if (hits.length === 0) {\n        iziToast.error({\n          message: 'No images found!',\n        });\n        loader.style.display = 'none';\n        return;\n      }\n\n      gallery.innerHTML += renderImages(hits);\n      loader.style.display = 'none';\n\n      totalPages = Math.ceil(totalHits / 40);\n      checkLastPage();\n      \n      lightbox.refresh();   \n      currentPage++;\n    })\n    .catch(error => {\n      console.error('Error fetching images:', error);\n      iziToast.error({\n        message: 'Error loading images. Please try again later!',\n      });\n      loader.style.display = 'none';\n    });\n};\n\nconst loadMoreImages = () => {\n  loader.style.display = 'block';\n  loadMoreBtn.style.display = 'none';\n\n  fetchAndRenderImages(currentSearchText).then(() => {\n    loader.style.display = 'none';\n    loadMoreBtn.style.display = 'block';\n  });\n};\n\n\nconst checkLastPage = () => {\n  if (currentPage >= totalPages) {\n    loadMoreBtn.style.display = 'none';\n  } else {\n    loadMoreBtn.style.display = 'block';\n  }\n};\n\nform.addEventListener('submit', createGallery);\nloadMoreBtn.addEventListener('click', loadMoreImages);"],"names":["currentPage","searchImage","search","perPage","url","loader","response","axios","error","resetPage","nextPage","renderImages","images","image","renderSingleImage","renderImageInfo","title","count","form","gallery","loadMoreBtn","lightbox","SimpleLightbox","iziToast","currentSearchText","totalPages","createGallery","e","fetchAndRenderImages","checkLastPage","searchText","hits","totalHits","loadMoreImages"],"mappings":"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"}